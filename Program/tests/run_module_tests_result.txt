C:\Users\adamh\.conda\envs\Data_Analysis\python.exe C:\Users\adamh\PycharmProjects\MagnumOpus\Program\run_module_tests.py
================================================================================
DIABETIC RETINOPATHY PROJECT - MODULE TESTING
================================================================================
Test started at: 2025-10-13 16:39:08
Testing 6 modules...
================================================================================

==================== TESTING CONFIG MODULE ====================
✓ Successfully imported config module
⚠ Warning: No test function found for config
  Expected function name: test_config_module

==================== TESTING UTILS MODULE ====================
✓ Successfully imported utils module
✓ Found test function: test_utils_module
Testing Utils module...
Testing system info...
==================================================
SYSTEM INFORMATION
==================================================
Python version: 3.12.9 | packaged by Anaconda, Inc. | (main, Feb  6 2025, 18:49:16) [MSC v.1929 64 bit (AMD64)]
PyTorch version: 2.8.0a0+gitfc14c65
CUDA available: True
CUDA version: None
GPU count: 1
GPU 0: AMD Radeon RX 9070 XT
Current working directory: C:\Users\adamh\PycharmProjects\MagnumOpus\Program
==================================================
✓ System info printed successfully
Testing device info...
Device info: {'device': 'cuda', 'cuda_available': True, 'device_count': 1, 'device_name': 'AMD Radeon RX 9070 XT', 'cuda_version': None}
✓ Device info retrieved successfully
Testing seed setting...
Random seed set to: 42
✓ Seed set successfully
Testing timestamp...
Current timestamp: 20251013_163924
✓ Timestamp generated successfully
Testing time formatting...
45 seconds = 45.00 seconds
125 seconds = 2m 5s
3665 seconds = 1h 1m 5s
✓ Time formatting successful
Testing directory creation...
Directory created/verified: C:\Users\adamh\AppData\Local\Temp\tmpbpv3nsk9\test_utils
✓ Directory creation successful
Testing JSON operations...
JSON data saved to: C:\Users\adamh\AppData\Local\Temp\tmpbpv3nsk9\test_utils\test.json
JSON data loaded from: C:\Users\adamh\AppData\Local\Temp\tmpbpv3nsk9\test_utils\test.json
✓ JSON operations successful
Testing experiment directory creation...
Directory created/verified: C:\Users\adamh\AppData\Local\Temp\tmpbpv3nsk9\test_utils\test_experiment
Directory created/verified: C:\Users\adamh\AppData\Local\Temp\tmpbpv3nsk9\test_utils\test_experiment\models
Directory created/verified: C:\Users\adamh\AppData\Local\Temp\tmpbpv3nsk9\test_utils\test_experiment\plots
Directory created/verified: C:\Users\adamh\AppData\Local\Temp\tmpbpv3nsk9\test_utils\test_experiment\logs
Directory created/verified: C:\Users\adamh\AppData\Local\Temp\tmpbpv3nsk9\test_utils\test_experiment\results
✓ Experiment directory creation successful
Testing parameter counting...
Total parameters: 55
Trainable parameters: 55
Non-trainable parameters: 0
✓ Parameter counting successful
Testing reproducibility...
Random seed set to: 42
✓ Reproducibility settings applied
✓ All utils tests successful
✓ Utils module test PASSED
✓ UTILS MODULE TEST: PASSED

==================== TESTING DATA MODULE ====================
2025-10-13 16:39:25,875 - data - INFO - Initialized Pipeline A with target size: 224x224
2025-10-13 16:39:25,875 - data - INFO - Initialized Pipeline B with target size: 299x299
2025-10-13 16:39:25,875 - data - INFO - Initializing CustomDataLoader...
2025-10-13 16:39:25,875 - data - INFO - Initialized Pipeline A with target size: 224x224
2025-10-13 16:39:25,875 - data - INFO - Initialized Pipeline B with target size: 299x299
2025-10-13 16:39:25,875 - data - INFO - CustomDataLoader initialization complete
2025-10-13 16:39:25,875 - data - INFO - ==================================================
2025-10-13 16:39:25,875 - data - INFO - STARTING DATA LOADING PROCESS
2025-10-13 16:39:25,875 - data - INFO - ==================================================
2025-10-13 16:39:25,875 - data - INFO - Loading APTOS dataset...
2025-10-13 16:39:25,875 - data - INFO - Checking APTOS data availability...
2025-10-13 16:39:25,876 - data - INFO - Found APTOS training CSV: C:\Users\adamh\PycharmProjects\MagnumOpus\Data\Aptos\train.csv
2025-10-13 16:39:25,879 - data - INFO - Successfully read APTOS training CSV with 3662 rows
✓ Successfully imported data module
✓ Found test function: test_data_module
Testing Data module...
✓ Config imported and created successfully
Testing Pipeline classes...
✓ Pipeline A and B created successfully
Testing transforms...
✓ All transforms created successfully
Testing CustomDataLoader creation...
✓ CustomDataLoader created successfully
Testing data loading process...
2025-10-13 16:39:25,911 - data - INFO - Added image paths and dataset labels to APTOS training data
2025-10-13 16:39:26,375 - data - INFO - All APTOS training images found successfully
2025-10-13 16:39:26,375 - data - INFO - Loaded 3662 APTOS training samples
2025-10-13 16:39:26,375 - data - INFO - Found APTOS test CSV: C:\Users\adamh\PycharmProjects\MagnumOpus\Data\Aptos\test.csv
2025-10-13 16:39:26,386 - data - INFO - Successfully read APTOS test CSV with 1928 rows
2025-10-13 16:39:26,405 - data - INFO - Added image paths to APTOS test data
2025-10-13 16:39:26,647 - data - INFO - All APTOS test images found successfully
2025-10-13 16:39:26,647 - data - INFO - Loaded 1928 APTOS test samples
2025-10-13 16:39:26,647 - data - INFO - Loading EyePACS dataset...
2025-10-13 16:39:26,647 - data - INFO - Checking EyePACS data availability...
2025-10-13 16:39:26,647 - data - INFO - Found EyePACS training CSV: C:\Users\adamh\PycharmProjects\MagnumOpus\Data\EyePacs\trainLabels.csv
2025-10-13 16:39:26,647 - data - ERROR - Failed to load EyePACS training data: [Errno 13] Permission denied: 'C:\\Users\\adamh\\PycharmProjects\\MagnumOpus\\Data\\EyePacs\\trainLabels.csv'
2025-10-13 16:39:26,647 - data - ERROR - Failed to load data: [Errno 13] Permission denied: 'C:\\Users\\adamh\\PycharmProjects\\MagnumOpus\\Data\\EyePacs\\trainLabels.csv'
⚠ Data loading failed (this is expected if data files are missing): [Errno 13] Permission denied: 'C:\\Users\\adamh\\PycharmProjects\\MagnumOpus\\Data\\EyePacs\\trainLabels.csv'
✓ Data module structure is correct even without data files
✓ Data module test PASSED
✓ DATA MODULE TEST: PASSED

==================== TESTING MODELS MODULE ====================
✓ Successfully imported models module
✓ Found test function: test_models_module
Testing Models module...
✓ Config imported and created successfully
Testing VGG16 model...
C:\Users\adamh\.conda\envs\Data_Analysis\Lib\site-packages\torchvision\models\_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
C:\Users\adamh\.conda\envs\Data_Analysis\Lib\site-packages\torchvision\models\_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Downloading: "https://download.pytorch.org/models/vgg16-397923af.pth" to C:\Users\adamh/.cache\torch\hub\checkpoints\vgg16-397923af.pth
100%|██████████| 528M/528M [00:06<00:00, 84.7MB/s]
✓ VGG16 model created successfully
  - Model name: VGG16
  - Number of classes: 5
  - Device: cuda
C:\Users\adamh\.conda\envs\Data_Analysis\Lib\site-packages\torchvision\models\_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
  - Output shape: torch.Size([1, 5])
  - Expected shape: (1, 5)
✓ VGG16 forward pass successful
  - Getting model summary for VGG16:
Model: VGG16Model
Total parameters: 121,581,237
Trainable parameters: 106,866,549
Testing RESNET50 model...
Downloading: "https://download.pytorch.org/models/resnet50-0676ba61.pth" to C:\Users\adamh/.cache\torch\hub\checkpoints\resnet50-0676ba61.pth
100%|██████████| 97.8M/97.8M [00:01<00:00, 73.2MB/s]
✓ RESNET50 model created successfully
  - Model name: ResNet50
  - Number of classes: 5
  - Device: cuda
C:\Users\adamh\.conda\envs\Data_Analysis\Lib\site-packages\torchvision\models\_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=Inception_V3_Weights.IMAGENET1K_V1`. You can also use `weights=Inception_V3_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
  - Output shape: torch.Size([1, 5])
  - Expected shape: (1, 5)
✓ RESNET50 forward pass successful
  - Getting model summary for RESNET50:
Model: ResNet50Model
Total parameters: 24,559,685
Trainable parameters: 1,051,653
Testing INCEPTIONV3 model...
Downloading: "https://download.pytorch.org/models/inception_v3_google-0cc3c7bd.pth" to C:\Users\adamh/.cache\torch\hub\checkpoints\inception_v3_google-0cc3c7bd.pth
100%|██████████| 104M/104M [00:01<00:00, 68.0MB/s]
✓ INCEPTIONV3 model created successfully
  - Model name: InceptionV3
  - Number of classes: 5
  - Device: cuda
  - Output shape: torch.Size([1, 5])
  - Expected shape: (1, 5)
✓ INCEPTIONV3 forward pass successful
  - Getting model summary for INCEPTIONV3:
Model: InceptionV3Model
Total parameters: 25,398,762
Trainable parameters: 1,055,882
✓ All models tested successfully
✓ Models module test PASSED
✓ MODELS MODULE TEST: PASSED

==================== TESTING TRAIN MODULE ====================
✓ Successfully imported train module
✓ Found test function: test_train_module
Testing Train module...
✓ Config imported and created successfully
Testing Trainer with VGG16 model...
✓ VGG16 model created
✓ Trainer created for VGG16
Setting up training components...
✓ Optimizer: Adam (lr=0.001)
✓ Loss function: CrossEntropyLoss
✗ Trainer test failed for vgg16: ReduceLROnPlateau.__init__() got an unexpected keyword argument 'verbose'
✗ TRAIN MODULE TEST: FAILED

==================== TESTING TEST MODULE ====================
✓ Successfully imported test module
✓ Found test function: test_test_module
Testing Test/Evaluation module...
✓ Config imported and created successfully
Testing Evaluator with VGG16 model...
✓ VGG16 model created
✓ Evaluator created for VGG16
✓ All evaluator attributes present for VGG16
Testing metric calculations for VGG16...
==================================================
CALCULATING METRICS
==================================================
Overall Accuracy: 0.2400
Weighted Precision: 0.2654
Weighted Recall: 0.2400
Weighted F1-Score: 0.2482

Detailed Classification Report:
              precision    recall  f1-score   support

     Class 0     0.2778    0.2000    0.2326        25
     Class 1     0.1429    0.2143    0.1714        14
     Class 2     0.5000    0.3810    0.4324        21
     Class 3     0.2308    0.2609    0.2449        23
     Class 4     0.1053    0.1176    0.1111        17

    accuracy                         0.2400       100
   macro avg     0.2513    0.2348    0.2385       100
weighted avg     0.2654    0.2400    0.2482       100

✓ Metrics calculation successful for VGG16
Top 3 misclassified samples (by confidence):
1. Index: 5, True: 4, Pred: 1, Conf: 0.8584
2. Index: 52, True: 0, Pred: 3, Conf: 0.9405
3. Index: 64, True: 2, Pred: 1, Conf: 0.8377
✓ Misclassified samples analysis successful for VGG16
✓ VGG16 evaluator test completed
Testing Evaluator with RESNET50 model...
C:\Users\adamh\.conda\envs\Data_Analysis\Lib\site-packages\torchvision\models\_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
C:\Users\adamh\.conda\envs\Data_Analysis\Lib\site-packages\torchvision\models\_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
✓ RESNET50 model created
✓ Evaluator created for RESNET50
✓ All evaluator attributes present for RESNET50
Testing metric calculations for RESNET50...
==================================================
CALCULATING METRICS
==================================================
Overall Accuracy: 0.2000
Weighted Precision: 0.2022
Weighted Recall: 0.2000
Weighted F1-Score: 0.2001

Detailed Classification Report:
              precision    recall  f1-score   support

     Class 0     0.1667    0.2222    0.1905        18
     Class 1     0.2500    0.2222    0.2353        18
     Class 2     0.2381    0.2381    0.2381        21
     Class 3     0.2105    0.1905    0.2000        21
     Class 4     0.1500    0.1364    0.1429        22

    accuracy                         0.2000       100
   macro avg     0.2031    0.2019    0.2013       100
weighted avg     0.2022    0.2000    0.2001       100

✓ Metrics calculation successful for RESNET50
Top 3 misclassified samples (by confidence):
1. Index: 45, True: 4, Pred: 1, Conf: 0.9148
2. Index: 76, True: 4, Pred: 0, Conf: 0.6635
3. Index: 3, True: 2, Pred: 4, Conf: 0.9969
✓ Misclassified samples analysis successful for RESNET50
✓ RESNET50 evaluator test completed
Testing Evaluator with INCEPTIONV3 model...
C:\Users\adamh\.conda\envs\Data_Analysis\Lib\site-packages\torchvision\models\_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
C:\Users\adamh\.conda\envs\Data_Analysis\Lib\site-packages\torchvision\models\_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=Inception_V3_Weights.IMAGENET1K_V1`. You can also use `weights=Inception_V3_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
✓ INCEPTIONV3 model created
✓ Evaluator created for INCEPTIONV3
✓ All evaluator attributes present for INCEPTIONV3
Testing metric calculations for INCEPTIONV3...
==================================================
CALCULATING METRICS
==================================================
Overall Accuracy: 0.1900
Weighted Precision: 0.1935
Weighted Recall: 0.1900
Weighted F1-Score: 0.1894

Detailed Classification Report:
              precision    recall  f1-score   support

     Class 0     0.1176    0.0800    0.0952        25
     Class 1     0.3000    0.2609    0.2791        23
     Class 2     0.1765    0.2143    0.1935        14
     Class 3     0.1200    0.1765    0.1429        17
     Class 4     0.2381    0.2381    0.2381        21

    accuracy                         0.1900       100
   macro avg     0.1904    0.1939    0.1898       100
weighted avg     0.1935    0.1900    0.1894       100

✓ Metrics calculation successful for INCEPTIONV3
Top 3 misclassified samples (by confidence):
1. Index: 27, True: 1, Pred: 3, Conf: 0.6302
2. Index: 73, True: 3, Pred: 4, Conf: 0.5965
3. Index: 64, True: 0, Pred: 3, Conf: 0.7593
✓ Misclassified samples analysis successful for INCEPTIONV3
✓ INCEPTIONV3 evaluator test completed
✓ All evaluator tests successful
✓ Test module test PASSED
✓ TEST MODULE TEST: PASSED

================================================================================
TEST SUMMARY
================================================================================
Total modules tested: 6
Modules passed: 4
Modules failed: 2

DETAILED RESULTS:
----------------------------------------
✗ config    : FAIL
✓ utils     : PASS
✓ data      : PASS
✓ models    : PASS
✗ train     : FAIL
✓ test      : PASS

================================================================================
❌ SOME MODULES FAILED
Please check the detailed error messages above.
Fix the issues and run the tests again.
================================================================================
Test completed at: 2025-10-13 16:39:47
================================================================================

Process finished with exit code 1
